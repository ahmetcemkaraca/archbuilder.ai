{
  "schemas": [
    {
      "name": "DB.users",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "email": {"type": "string", "length": 256, "unique": true},
        "password_hash": {"type": "string", "length": 256},
        "role": {"type": "string", "length": 32},
        "is_active": {"type": "boolean"},
        "first_name": {"type": "string", "length": 100, "nullable": true},
        "last_name": {"type": "string", "length": 100, "nullable": true},
        "tenant_id": {"type": "string", "length": 36, "nullable": true},
        "last_login": {"type": "datetime", "nullable": true},
        "failed_login_attempts": {"type": "integer", "default": 0},
        "locked_until": {"type": "datetime", "nullable": true},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_users_email", "columns": ["email"]},
        {"name": "ix_users_role", "columns": ["role"]},
        {"name": "ix_users_tenant_id", "columns": ["tenant_id"]},
        {"name": "ix_users_is_active", "columns": ["is_active"]}
      ]
    },
    {
      "name": "DB.api_keys",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "name": {"type": "string", "length": 100},
        "key_hash": {"type": "string", "length": 256},
        "key_prefix": {"type": "string", "length": 10},
        "scopes": {"type": "json"},
        "usage_count": {"type": "integer", "default": 0},
        "last_used": {"type": "datetime", "nullable": true},
        "expires_at": {"type": "datetime", "nullable": true},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_api_keys_user_id", "columns": ["user_id"]},
        {"name": "ix_api_keys_key_hash", "columns": ["key_hash"], "unique": true},
        {"name": "ix_api_keys_key_prefix", "columns": ["key_prefix"]},
        {"name": "ix_api_keys_is_active", "columns": ["is_active"]}
      ]
    },
    {
      "name": "DB.refresh_tokens",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "token_hash": {"type": "string", "length": 256},
        "expires_at": {"type": "datetime"},
        "created_at": {"type": "datetime"},
        "revoked_at": {"type": "datetime", "nullable": true},
        "is_revoked": {"type": "boolean", "default": false}
      },
      "indexes": [
        {"name": "ix_refresh_tokens_user_id", "columns": ["user_id"]},
        {"name": "ix_refresh_tokens_token_hash", "columns": ["token_hash"], "unique": true},
        {"name": "ix_refresh_tokens_expires_at", "columns": ["expires_at"]},
        {"name": "ix_refresh_tokens_is_revoked", "columns": ["is_revoked"]}
      ]
    },
    {
      "name": "DB.user_sessions",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "ip_address": {"type": "string", "length": 45, "nullable": true},
        "user_agent": {"type": "string", "length": 512, "nullable": true},
        "expires_at": {"type": "datetime"},
        "created_at": {"type": "datetime"},
        "last_activity": {"type": "datetime"},
        "is_active": {"type": "boolean", "default": true}
      },
      "indexes": [
        {"name": "ix_user_sessions_user_id", "columns": ["user_id"]},
        {"name": "ix_user_sessions_expires_at", "columns": ["expires_at"]},
        {"name": "ix_user_sessions_is_active", "columns": ["is_active"]}
      ]
    },
    {
      "name": "DB.audit_logs",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "nullable": true},
        "tenant_id": {"type": "string", "length": 36, "nullable": true},
        "action": {"type": "string", "length": 100},
        "resource": {"type": "string", "length": 100, "nullable": true},
        "resource_id": {"type": "string", "length": 36, "nullable": true},
        "ip_address": {"type": "string", "length": 45, "nullable": true},
        "user_agent": {"type": "string", "length": 512, "nullable": true},
        "metadata": {"type": "json", "nullable": true},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_audit_logs_user_id", "columns": ["user_id"]},
        {"name": "ix_audit_logs_tenant_id", "columns": ["tenant_id"]},
        {"name": "ix_audit_logs_action", "columns": ["action"]},
        {"name": "ix_audit_logs_created_at", "columns": ["created_at"]}
      ]
    },
    {
      "name": "AICommandPreview",
      "type": "object",
      "properties": {
        "selectedModel": {"type": "object"},
        "prompt": {"type": "string"},
        "preview": {"type": "object"}
      }
    },
    {
      "name": "ValidationRequest",
      "type": "object",
      "properties": {
        "payload": {"type": "object"},
        "building_type": {"type": "string"}
      },
      "required": ["payload"]
    },
    {
      "name": "ValidationResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "AICommandCreateRequest",
      "type": "object",
      "properties": {
        "command": {"type": "string"},
        "input": {"type": "object"},
        "user_id": {"type": "string"},
        "project_id": {"type": "string"}
      },
      "required": ["command"]
    },
    {
      "name": "AICommandResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "ChunkingConfig",
      "type": "object",
      "properties": {
        "max_chars": {"type": "integer", "minimum": 50, "maximum": 5000},
        "overlap": {"type": "integer", "minimum": 0, "maximum": 1000}
      },
      "required": ["max_chars", "overlap"]
    },
    {
      "name": "DB.projects",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "owner_id": {"type": "string", "length": 36, "fk": "users.id"},
        "name": {"type": "string", "length": 200},
        "description": {"type": "text", "nullable": true},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_projects_owner_id", "columns": ["owner_id"]},
        {"name": "ix_projects_name", "columns": ["name"]}
      ]
    },
    {
      "name": "DB.ai_commands",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id", "nullable": true},
        "project_id": {"type": "string", "length": 36, "fk": "projects.id", "nullable": true},
        "command": {"type": "string", "length": 100},
        "input": {"type": "json"},
        "output": {"type": "json", "nullable": true},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_ai_commands_user_id", "columns": ["user_id"]},
        {"name": "ix_ai_commands_project_id", "columns": ["project_id"]}
      ]
    },
    {
      "name": "DB.subscriptions",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "plan": {"type": "string", "length": 50},
        "started_at": {"type": "datetime"},
        "ends_at": {"type": "datetime", "nullable": true}
      },
      "indexes": [
        {"name": "ix_subscriptions_user_id", "columns": ["user_id"]}
      ]
    },
    {
      "name": "DB.usage",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "usage_type": {"type": "string", "length": 50},
        "units": {"type": "integer"},
        "date": {"type": "date"},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_usage_user_id", "columns": ["user_id"]},
        {"name": "ix_usage_usage_type", "columns": ["usage_type"]},
        {"name": "ix_usage_date", "columns": ["date"]}
      ]
    },
    {
      "name": "DB.rag_dataset_links",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "owner_id": {"type": "string", "length": 36, "fk": "users.id"},
        "project_id": {"type": "string", "length": 36, "fk": "projects.id"},
        "dataset_id": {"type": "string", "length": 64},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_rag_dataset_links_owner_id", "columns": ["owner_id"]},
        {"name": "ix_rag_dataset_links_project_id", "columns": ["project_id"]},
        {"name": "ix_rag_dataset_links_dataset_id", "columns": ["dataset_id"]}
      ]
    },
    {
      "name": "DB.rag_jobs",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "job_type": {"type": "string", "length": 50},
        "status": {"type": "string", "length": 20},
        "dataset_id": {"type": "string", "length": 64},
        "result_json": {"type": "text", "nullable": true},
        "error_message": {"type": "text", "nullable": true},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_rag_jobs_job_type", "columns": ["job_type"]},
        {"name": "ix_rag_jobs_status", "columns": ["status"]},
        {"name": "ix_rag_jobs_dataset_id", "columns": ["dataset_id"]}
      ]
    },
    {
      "name": "DB.rag_document_links",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "dataset_id": {"type": "string", "length": 64},
        "document_id": {"type": "string", "length": 64},
        "filename": {"type": "string", "length": 255},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_rag_document_links_dataset_id", "columns": ["dataset_id"]},
        {"name": "ix_rag_document_links_document_id", "columns": ["document_id"]}
      ]
    },
    {
      "name": "HealthResponse",
      "type": "object",
      "properties": {
        "status": {"type": "string"},
        "name": {"type": "string"}
      },
      "required": ["status", "name"]
    },
    {
      "name": "AuthRegisterRequest",
      "type": "object",
      "properties": {
        "email": {"type": "string", "format": "email"},
        "password": {"type": "string", "minLength": 8},
        "first_name": {"type": "string", "minLength": 1, "maxLength": 100},
        "last_name": {"type": "string", "minLength": 1, "maxLength": 100},
        "tenant_id": {"type": "string", "nullable": true}
      },
      "required": ["email", "password", "first_name", "last_name"]
    },
    {
      "name": "AuthLoginRequest",
      "type": "object",
      "properties": {
        "email": {"type": "string", "format": "email"},
        "password": {"type": "string"}
      },
      "required": ["email", "password"]
    },
    {
      "name": "AuthUserResponse",
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "email": {"type": "string"},
        "first_name": {"type": "string"},
        "last_name": {"type": "string"},
        "role": {"type": "string", "enum": ["admin", "user", "viewer"]},
        "tenant_id": {"type": "string", "nullable": true},
        "is_active": {"type": "boolean"},
        "last_login": {"type": "string", "format": "date-time", "nullable": true},
        "created_at": {"type": "string", "format": "date-time"}
      },
      "required": ["id", "email", "first_name", "last_name", "role", "is_active", "created_at"]
    },
    {
      "name": "AuthTokenResponse",
      "type": "object",
      "properties": {
        "access_token": {"type": "string"},
        "refresh_token": {"type": "string"},
        "token_type": {"type": "string", "default": "bearer"},
        "expires_in": {"type": "integer"},
        "user": {"$ref": "#/definitions/AuthUserResponse"}
      },
      "required": ["access_token", "refresh_token", "token_type", "expires_in", "user"]
    },
    {
      "name": "RefreshRequest",
      "type": "object",
      "properties": {
        "refresh_token": {"type": "string"}
      },
      "required": ["refresh_token"]
    },
    {
      "name": "ApiKeyCreateRequest",
      "type": "object",
      "properties": {
        "name": {"type": "string", "minLength": 1, "maxLength": 100},
        "scopes": {"type": "array", "items": {"type": "string"}},
        "expires_in_days": {"type": "integer", "minimum": 1, "maximum": 365, "nullable": true}
      },
      "required": ["name"]
    },
    {
      "name": "ApiKeyResponse",
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "name": {"type": "string"},
        "key": {"type": "string", "description": "Only returned on creation"},
        "key_prefix": {"type": "string"},
        "scopes": {"type": "array", "items": {"type": "string"}},
        "usage_count": {"type": "integer"},
        "last_used": {"type": "string", "format": "date-time", "nullable": true},
        "expires_at": {"type": "string", "format": "date-time", "nullable": true},
        "is_active": {"type": "boolean"},
        "created_at": {"type": "string", "format": "date-time"}
      },
      "required": ["id", "name", "key_prefix", "scopes", "usage_count", "is_active", "created_at"]
    },
    {
      "name": "UserSessionResponse",
      "type": "object", 
      "properties": {
        "id": {"type": "string"},
        "ip_address": {"type": "string", "nullable": true},
        "user_agent": {"type": "string", "nullable": true},
        "expires_at": {"type": "string", "format": "date-time"},
        "created_at": {"type": "string", "format": "date-time"},
        "last_activity": {"type": "string", "format": "date-time"},
        "is_active": {"type": "boolean"},
        "is_current": {"type": "boolean", "description": "True if this is the current session"}
      },
      "required": ["id", "expires_at", "created_at", "last_activity", "is_active", "is_current"]
    },
    {
      "name": "APIKeyResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "UploadInitResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "StandardResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "RAGQueryRequest",
      "type": "object",
      "properties": {
        "query": {"type": "string"},
        "document_types": {"type": "array", "items": {"type": "string"}},
        "languages": {"type": "array", "items": {"type": "string"}},
        "max_results": {"type": "integer", "minimum": 1, "maximum": 100},
        "similarity_threshold": {"type": "number", "minimum": 0, "maximum": 1},
        "filters": {"type": "object"},
        "dataset_ids": {"type": "array", "items": {"type": "string"}},
        "document_ids": {"type": "array", "items": {"type": "string"}},
        "top_k": {"type": "integer", "minimum": 1, "maximum": 100},
        "vector_similarity_weight": {"type": "number", "minimum": 0}
      },
      "required": ["query"]
    },
    {
      "name": "RAGQueryResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "EnsureDatasetRequest",
      "type": "object",
      "properties": {
        "owner_id": {"type": "string"},
        "project_id": {"type": "string"},
        "preferred_name": {"type": "string"}
      },
      "required": ["owner_id", "project_id", "preferred_name"]
    },
    {
      "name": "EnsureDatasetResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "UploadParseResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {"type": "object"}
      },
      "required": ["success", "data"]
    },
    {
      "name": "IndexBuildRequest",
      "type": "object",
      "properties": {
        "dataset_id": {"type": "string"},
        "rebuild": {"type": "boolean"}
      },
      "required": ["dataset_id"]
    },
    {
      "name": "HybridSearchRequest",
      "type": "object",
      "properties": {
        "query": {"type": "string"},
        "dataset_ids": {"type": "array", "items": {"type": "string"}},
        "max_results": {"type": "integer", "minimum": 1, "maximum": 100},
        "keyword_boost": {"type": "number", "minimum": 0, "maximum": 1},
        "dense_boost": {"type": "number", "minimum": 0, "maximum": 1},
        "filters": {"type": "object"}
      },
      "required": ["query"]
    },
    {
      "name": "ProjectAnalysisRequest",
      "type": "object",
      "properties": {
        "project_id": {"type": "string"},
        "analysis_type": {"type": "string", "enum": ["geometry", "code", "both"]},
        "options": {"type": "object"}
      },
      "required": ["project_id", "analysis_type"]
    },
    {
      "name": "ProjectAnalysisResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {
          "type": "object",
          "properties": {
            "geometry_analysis": {"type": "object"},
            "code_analysis": {"type": "object"},
            "recommendations": {"type": "array", "items": {"type": "string"}},
            "confidence_score": {"type": "number", "minimum": 0, "maximum": 1}
          }
        }
      },
      "required": ["success", "data"]
    },
    {
      "name": "DB.validation_results",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "payload": {"type": "json"},
        "building_type": {"type": "string", "length": 50},
        "results": {"type": "json"},
        "overall_success": {"type": "boolean"},
        "correlation_id": {"type": "string", "length": 100, "nullable": true},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_validation_results_building_type", "columns": ["building_type"]},
        {"name": "ix_validation_results_overall_success", "columns": ["overall_success"]},
        {"name": "ix_validation_results_correlation_id", "columns": ["correlation_id"]}
      ]
    },
    {
      "name": "DB.review_items",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "item_type": {"type": "string", "length": 50},
        "item_data": {"type": "json"},
        "status": {"type": "string", "length": 20},
        "priority": {"type": "string", "length": 20},
        "assigned_to": {"type": "string", "length": 100, "nullable": true},
        "assigned_at": {"type": "datetime", "nullable": true},
        "assigned_by": {"type": "string", "length": 100, "nullable": true},
        "reviewed_by": {"type": "string", "length": 100, "nullable": true},
        "reviewed_at": {"type": "datetime", "nullable": true},
        "comments": {"type": "text", "nullable": true},
        "feedback_data": {"type": "json", "nullable": true},
        "project_id": {"type": "string", "length": 100, "nullable": true},
        "created_by": {"type": "string", "length": 100, "nullable": true},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_review_items_status", "columns": ["status"]},
        {"name": "ix_review_items_priority", "columns": ["priority"]},
        {"name": "ix_review_items_assigned_to", "columns": ["assigned_to"]},
        {"name": "ix_review_items_project_id", "columns": ["project_id"]}
      ]
    },
    {
      "name": "JobAcceptedResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {
          "type": "object",
          "properties": {
            "job_id": {"type": "string"},
            "status": {"type": "string"},
            "estimated_completion": {"type": "string", "format": "date-time"}
          },
          "required": ["job_id", "status"]
        }
      },
      "required": ["success", "data"]
    },
    {
      "name": "JobStatusResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean"},
        "data": {
          "type": "object",
          "properties": {
            "job_id": {"type": "string"},
            "status": {"type": "string", "enum": ["pending", "processing", "completed", "failed"]},
            "progress": {"type": "integer", "minimum": 0, "maximum": 100},
            "result": {"type": "object", "nullable": true},
            "error_message": {"type": "string", "nullable": true}
          },
          "required": ["job_id", "status"]
        }
      },
      "required": ["success", "data"]
    },
    {
      "name": "RAGFlowDataset",
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "name": {"type": "string"},
        "created_at": {"type": "string", "format": "date-time"},
        "document_count": {"type": "integer"},
        "chunk_count": {"type": "integer"},
        "status": {"type": "string", "enum": ["active", "building", "error"]}
      },
      "required": ["id", "name", "created_at"]
    },
    {
      "name": "RAGFlowDocument",
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "filename": {"type": "string"},
        "file_size": {"type": "integer"},
        "content_type": {"type": "string"},
        "uploaded_at": {"type": "string", "format": "date-time"},
        "processed_at": {"type": "string", "format": "date-time", "nullable": true},
        "status": {"type": "string", "enum": ["uploaded", "processing", "processed", "error"]},
        "chunk_count": {"type": "integer", "nullable": true}
      },
      "required": ["id", "filename", "file_size", "uploaded_at", "status"]
    },
    {
      "name": "RAGFlowChunk",
      "type": "object",
      "properties": {
        "id": {"type": "string"},
        "content": {"type": "string"},
        "document_id": {"type": "string"},
        "chunk_index": {"type": "integer"},
        "similarity_score": {"type": "number", "minimum": 0, "maximum": 1},
        "metadata": {"type": "object", "nullable": true}
      },
      "required": ["id", "content", "document_id", "chunk_index"]
    },
    {
      "name": "SecurityViolationResponse",
      "type": "object",
      "properties": {
        "success": {"type": "boolean", "default": false},
        "error": {
          "type": "object",
          "properties": {
            "message": {"type": "string"},
            "correlation_id": {"type": "string"},
            "timestamp": {"type": "integer"},
            "violation_type": {"type": "string", "enum": ["sql_injection", "xss", "path_traversal", "threat_detected", "file_security"]}
          },
          "required": ["message", "correlation_id", "timestamp"]
        }
      },
      "required": ["success", "error"]
    },
    {
      "name": "ValidationResult",
      "type": "object",
      "properties": {
        "valid": {"type": "boolean"},
        "sanitized_data": {"type": "any"},
        "errors": {"type": "array", "items": {"type": "string"}},
        "warnings": {"type": "array", "items": {"type": "string"}},
        "metadata": {"type": "object"}
      },
      "required": ["valid", "errors", "warnings", "metadata"]
    },
    {
      "name": "SecurityConfig",
      "type": "object",
      "properties": {
        "allow_html": {"type": "boolean", "default": false},
        "allowed_html_tags": {"type": "array", "items": {"type": "string"}},
        "allowed_html_attributes": {"type": "object"},
        "max_file_size": {"type": "integer", "minimum": 1024},
        "allowed_file_extensions": {"type": "array", "items": {"type": "string"}},
        "blocked_file_extensions": {"type": "array", "items": {"type": "string"}},
        "max_string_length": {"type": "integer", "minimum": 1},
        "max_list_length": {"type": "integer", "minimum": 1},
        "max_dict_depth": {"type": "integer", "minimum": 1},
        "enable_sql_injection_detection": {"type": "boolean", "default": true},
        "enable_xss_detection": {"type": "boolean", "default": true},
        "enable_path_traversal_detection": {"type": "boolean", "default": true}
      }
    },
    {
      "name": "CADFileValidationResult",
      "type": "object",
      "properties": {
        "valid": {"type": "boolean"},
        "file_format": {"type": "string"},
        "file_size": {"type": "integer"},
        "estimated_cad_version": {"type": "string", "nullable": true},
        "errors": {"type": "array", "items": {"type": "string"}},
        "warnings": {"type": "array", "items": {"type": "string"}},
        "metadata": {
          "type": "object",
          "properties": {
            "dwg_version": {"type": "string", "nullable": true},
            "dxf_version": {"type": "string", "nullable": true},
            "ifc_schema": {"type": "string", "nullable": true},
            "estimated_revit_version": {"type": "string", "nullable": true},
            "step_description": {"type": "string", "nullable": true}
          }
        }
      },
      "required": ["valid", "file_format", "file_size", "errors", "warnings", "metadata"]
    },
    {
      "name": "VaultSecretMetadata",
      "type": "object",
      "properties": {
        "path": {"type": "string"},
        "version": {"type": "integer"},
        "created_time": {"type": "string", "format": "date-time"},
        "deletion_time": {"type": "string", "format": "date-time", "nullable": true},
        "destroyed": {"type": "boolean", "default": false},
        "custom_metadata": {"type": "object"}
      },
      "required": ["path", "version", "created_time", "destroyed", "custom_metadata"]
    },
    {
      "name": "VaultSecretValue",
      "type": "object",
      "properties": {
        "data": {"type": "object"},
        "metadata": {"$ref": "#/definitions/VaultSecretMetadata"}
      },
      "required": ["data", "metadata"]
    },
    {
      "name": "DB.security_events",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "event_type": {"type": "string", "length": 100},
        "severity": {"type": "string", "length": 20},
        "user_id": {"type": "string", "length": 36, "nullable": true, "fk": "users.id"},
        "ip_address": {"type": "string", "length": 45},
        "user_agent": {"type": "string", "length": 512, "nullable": true},
        "request_path": {"type": "string", "length": 255, "nullable": true},
        "payload": {"type": "text", "nullable": true},
        "blocked": {"type": "boolean", "default": false},
        "correlation_id": {"type": "string", "length": 100, "nullable": true},
        "metadata": {"type": "json", "nullable": true},
        "created_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_security_events_event_type", "columns": ["event_type"]},
        {"name": "ix_security_events_severity", "columns": ["severity"]},
        {"name": "ix_security_events_user_id", "columns": ["user_id"]},
        {"name": "ix_security_events_ip_address", "columns": ["ip_address"]},
        {"name": "ix_security_events_blocked", "columns": ["blocked"]},
        {"name": "ix_security_events_created_at", "columns": ["created_at"]}
      ]
    },
    {
      "name": "DB.rate_limits",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "key": {"type": "string", "length": 255, "unique": true},
        "limit_type": {"type": "string", "length": 50},
        "count": {"type": "integer", "default": 0},
        "window_start": {"type": "datetime"},
        "window_size": {"type": "integer"},
        "limit_value": {"type": "integer"},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_rate_limits_key", "columns": ["key"]},
        {"name": "ix_rate_limits_limit_type", "columns": ["limit_type"]},
        {"name": "ix_rate_limits_window_start", "columns": ["window_start"]}
      ]
    },
    {
      "name": "DB.file_uploads",
      "type": "table",
      "columns": {
        "id": {"type": "string", "length": 36, "primary_key": true},
        "user_id": {"type": "string", "length": 36, "fk": "users.id"},
        "filename": {"type": "string", "length": 255},
        "original_filename": {"type": "string", "length": 255},
        "file_size": {"type": "integer"},
        "content_type": {"type": "string", "length": 100},
        "file_hash": {"type": "string", "length": 64},
        "storage_path": {"type": "string", "length": 500},
        "validation_status": {"type": "string", "length": 20},
        "validation_errors": {"type": "json", "nullable": true},
        "scan_status": {"type": "string", "length": 20, "default": "pending"},
        "scan_results": {"type": "json", "nullable": true},
        "is_quarantined": {"type": "boolean", "default": false},
        "metadata": {"type": "json", "nullable": true},
        "created_at": {"type": "datetime"},
        "updated_at": {"type": "datetime"}
      },
      "indexes": [
        {"name": "ix_file_uploads_user_id", "columns": ["user_id"]},
        {"name": "ix_file_uploads_file_hash", "columns": ["file_hash"]},
        {"name": "ix_file_uploads_validation_status", "columns": ["validation_status"]},
        {"name": "ix_file_uploads_scan_status", "columns": ["scan_status"]},
        {"name": "ix_file_uploads_is_quarantined", "columns": ["is_quarantined"]},
        {"name": "ix_file_uploads_created_at", "columns": ["created_at"]}
      ]
    }
  ]
}

